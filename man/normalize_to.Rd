% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{normalize_to}
\alias{normalize_to}
\title{Normalize WhatsApp contact IDs (phone numbers only)}
\usage{
normalize_to(to)
}
\arguments{
\item{to}{Character. A character vector of WhatsApp phone numbers in free
text format. Each element may include symbols, spaces, etc.}
}
\value{
A character vector of the same length as \code{to}, containing digit-only
normalized numbers.
Raises an error (\code{cli_abort}) if any element cannot be normalized
to 12 or 13 digits.
}
\description{
Cleans and normalizes WhatsApp phone numbers by:
\itemize{
\item Removing all non-digit characters (\code{+}, spaces, parentheses, hyphens, etc.);
\item Removing the \strong{ninth digit} (when present) right after the country code
(CC) and area code (SS), in order to standardize the length to 12 or
13 digits (mobile with ninth digit).
}
}
\details{
This function is primarily designed for \strong{Brazilian E.164 numbers} (e.g.,
\verb{+55 (81) 9XXXX-YYYY}):
\itemize{
\item After removing non-digits, valid numbers must contain \strong{12 or 13 digits}:
\itemize{
\item \strong{12 digits} → CC(2) + SS(2) + 8-digit number (landline);
\item \strong{13 digits} → CC(2) + SS(2) + 9 + 8-digit number (mobile).
}
\item The regex pattern \code{"(\\\\d{2})(\\\\d{2})(\\\\d{1})(\\\\d{8})" -> "\\\\1\\\\2\\\\4"}
strips out the middle digit (the ninth digit) when it occurs exactly at
that position (after CC and SS).
}
}
\section{Validation}{

\itemize{
\item Valid numbers must be \strong{12 or 13 digits} after cleanup;
\item The error message will show how many and which indices failed validation.
}
}

\examples{
# Mobile and landline examples (Brazil):
normalize_to("+55 (81) 9 1234-5678")
# -> "558112345678" (removes the ninth digit)

normalize_to("55 81 3123-4567")
# -> "558131234567"

# Multiple inputs:
normalize_to(c("+55 (81) 9 8765-4321", "55-81-3876-1234"))

# Error example: invalid length
\dontrun{
normalize_to("5581")  # error: wrong number of digits
}

}
